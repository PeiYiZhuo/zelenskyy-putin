---
layout: post
title: "A Comparison Zelenskyy and Putin Press Releases"
output: 
  md_document:
    variant: gfm
    preserve_yaml: True
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-packages, include=FALSE}
library(countrycode)
library(tidyverse)
library(lubridate)
library(patchwork)
library(tidytext)
library(scales)
library(here)
```

# A Comparison of Zelenskyy and Putin Press Releases 

Russia launched its full-scale invasion of Ukraine on February 24, 2022, turning a conflict that has marred the region since 2014 into the largest war on European soil since the defeat of Nazi Germany in 1945. (For more context, I recommend this [New York Times article](https://www.nytimes.com/article/russia-ukraine-nato-europe.html) and this [piece from the Council on Foreign Relations](https://www.cfr.org/global-conflict-tracker/conflict/conflict-ukraine).) As the Ukrainian and Russian armed forces struggle to gain the upper hand on the battlefield, the two governments are also prosecuting an information war for the hearts and minds of the world. 

For a glimpse of how this parallel war of words and images is being waged, I decided to use the tools of data science to take a look at the English language press releases that the two countries have been producing. I obtained the data for this analysis by scraping the news sections of the English language websites of [the President of Ukraine](https://www.president.gov.ua/en/news/all) and [the Kremlin](http://en.kremlin.ru/events/president/news). The 1033 pieces I scraped are dated from February 24, 2022, the day that Russia launched their latest assault on Ukraine, to June 25, 2022. These pieces encompass the announcements made by the two leaders over the initial four months of the conflict.

According to my analysis, which is modeled after [David Robinson's analysis of Donald Trump's tweets](http://varianceexplained.org/r/trump-tweets/), Zelenskyy's press releases demonstrate more concern about the war in Ukraine than do the press releases of the Kremlin.

```{r load-data}
# https://community.rstudio.com/t/error-message-bad-restore-file-magic-number-file-may-be-corrupted-no-data-loaded/48649
load(here("press_release_data", "zelenskyy.RData"))
load(here("press_release_data", "putin.RData"))
```

```{r combine-data}
putin <- putin %>%
  mutate(
    # Combine press release summary with text
    text = ifelse(summary != "", paste(summary, text), text),
    origin = "putin"
  ) %>%
  select(-c(location, summary))

zelenskyy <- mutate(zelenskyy, origin = "zelensky") 

articles <- zelenskyy %>%
  rbind(putin) %>%
  mutate(text = ifelse(headline != "", paste(headline, text), text)) 
```

### Press Release Volume Over Time

After combining the two data sets corresponding to Zelenskyy press releases and Putin press releases, we made the plot below. Each observation in the combined data set is associated with a piece from either Zelenskyy's or Putin's website. 

```{r releases-over-time}
pieces_by_day <- articles %>%
  mutate(
    date = date(date),
    origin = ifelse(origin == "putin", "Putin", "Zelenskyy")
  ) %>%
  group_by(date, origin) %>%
  count()

pieces_by_day %>%
  ggplot(aes(x = date, y = n)) +
    geom_line(size = 0.4) +
    labs(
      x = "Date",
      y = "Pieces",
      title = "Zelenskyy publishes more press releases on average than Putin"
    ) +
    geom_smooth(method = lm, formula = y ~ 1, se = FALSE, size = 0.4, linetype = "dashed", color = "red") +
    facet_wrap(~ origin, nrow = 1) +
    guides(color = guide_legend("Government")) +
    theme_minimal()
```

Zelenskyy's busiest day for press releases was Feburary 24, the day Russia invaded his country. Meanwhile, the busiest day for announcements from Putin was April 12, the day he visited a cosmodrome, an event that is unrelated to the war in Ukraine. This could be seen as an indication of the messaging priorities of the two leaders. While Zelenskyy is attempting to raise the alarm regarding the threat to his country, Putin is attempting to downplay the conflict through both the volume and the content of his press releases. 

### Countries Mentioned in Press Releases

Using the `codelist` of names provided by the `countrycode` package, we were able to determine the top 10 most-mentioned countries for Zelenskyy and Putin respectively. These two lists have 6 nations in common.

```{r countries}
# Regular expression of countries
countries <- paste(codelist$country.name.en, collapse = "|")

mentioned_countries <- articles %>%
  mutate(countries = str_extract_all(text, countries)) %>%
  select(origin, headline, countries) %>%
  unnest_longer(countries) %>%
  group_by(origin, countries) %>%
  summarize(n = n() / length(unique(.$headline))) %>%
  do(head(arrange(., desc(n)), 10)) 
  
zelensky_countries <- mentioned_countries %>%
  filter(origin == "zelensky") %>%
  pull(countries)

putin_countries <- mentioned_countries %>%
  filter(origin == "putin") %>%
  pull(countries)

top_countries <- zelensky_countries[zelensky_countries %in% putin_countries]

mentioned_countries %>%
  mutate(origin = ifelse(origin == "putin", "Putin", "Zelenskyy")) %>%
  filter(countries %in% top_countries) %>%
  ggplot(aes(y = reorder(countries, n), x = n, fill = origin)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    x = "Mentions per piece",
    y = "Country",
    title = "Ukraine mentions Russia most but not vice versa"
  ) +
  guides(fill = guide_legend("Government")) +
  theme_minimal()
```

The above plot displays the countries that are among the top 10 most-mentioned for both Zelenskyy and Putin. Zelenskyy mentions Russia the most with Ukraine coming in close behind. However, Putin does not return the favor. Instead of mentioning Ukraine the most, the Kremlin prefers to talk about itself, at a rate far ahead of references to its neighbor. This discrepancy points again to an attempt, on the part of Putin, to downplay the conflict. While Zelenskyy is hyper-focused on his enemy, Russia, Putin shows less interest in discussing Ukraine despite the fact that Russia is waging an active war in that country.  

### The Use of "War" vs. "Special Military Operation"

```{r word-data-set}
words <- articles %>%
  unnest_tokens(word, text) %>%
  anti_join(stop_words, by = "word")
```

A much-discussed aspect of Russian messaging about the conflict has been their refusal to describe it as a war, instead using the term "special military operation." By contrast, Zelenskyy does not seem to have an issue with using the word "war." The use of obfuscating language by Putin contributes additional evidence in support of the claim that he is minimizing the war.

```{r war-use}
war <- words %>%
  mutate(origin = ifelse(origin == "putin", "Putin", "Zelenskyy")) %>%
  group_by(origin) %>%
  summarize(
    mentions_per_article = sum(word == "war") / length(unique(headline))
  ) %>%
  ggplot(aes(x = mentions_per_article, y = origin)) +
  geom_bar(stat = "identity") +
  labs(
    x = "",
    y = "",
    title = '"War"'
  ) +
  theme_minimal()

smo <- articles %>%
  mutate(origin = ifelse(origin == "putin", "Putin", "Zelenskyy")) %>%
  mutate(
    # https://github.com/rstudio/cheatsheets/blob/main/strings.pdf
    smo = str_count(text, "special military operation|Special military operation")
  ) %>%
  group_by(origin) %>%
  summarize(
    mentions_per_article = sum(smo) / n()
  ) %>%
  ggplot(aes(x = mentions_per_article, y = origin)) +
  geom_bar(stat = "identity") +
  labs(
    x = "Mentions per piece",
    y = "",
    title = '"Special Military Operation"'
  ) +
  theme_minimal()

war / smo
```

After using `unnest_tokens` from the `tidytext` package to create a data set of words and eliminating stop words ("the", "and", "so", etc.) from the data set, we found that this verbal distinction between the two leaders is apparent in their press releases.  

### Sentiment Analysis

```{r add-sentiments}
# https://www.tidytextmining.com/sentiment.html
nrc <- get_sentiments("nrc")
words <- words %>%
  add_count(origin) %>%
  left_join(nrc, by = "word") %>%
  group_by(origin, sentiment, total = n) %>%
  count(name = "number") %>%
  filter(!is.na(sentiment)) 
```

Using the data set of words created in the previous section, we were able to conduct a comparison of the sentiments found in the Zelenskyy and Putin press releases along the lines of the one that David Robinson conducted on iPhone and Android tweets from Donald Trump's Twitter timeline.

```{r sentiment-bar}
words %>%
  mutate(origin = ifelse(origin == "putin", "Putin", "Zelenskyy")) %>%
  ggplot(
    aes(
      # https://stackoverflow.com/questions/5208679/order-bars-in-ggplot2-bar-graph
      x = number / total, 
      y = reorder(sentiment, number / total),
      fill = origin,
      color = sentiment %in% c("negative", "fear", "anger")
    )
  ) +
  scale_color_manual(values = c("transparent", "black")) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    x = "Proportion of words",
    y = "Sentiment",
    title = "Zelenskyy is more negative, fearful, and angry than Putin"
  ) +
  guides(
    color = "none",
    fill = guide_legend("Government")
  ) +
  theme_minimal() +
  theme(
    # https://stackoverflow.com/questions/20609716/changing-format-of-some-axis-labels-in-ggplot2-according-to-condition
    axis.text.y = element_text(
      face = c("plain", "plain", "plain", "bold", "plain", "plain", 
               "bold", "bold", "plain", "plain", "plain")
    )
  )
```

There are dramatic differences between Zelenskyy and Putin in terms of the proportions of their words that connote negative, fearful, and angry sentiments respectively. Zelenskyy is more likely to display all three of these sentiments. Results from Poisson tests (visualized below) confirm this finding as statistically significant.

```{r sentiment-poisson}
words %>%
  group_by(sentiment) %>%
  # https://www.datasciencemadesimple.com/reverse-the-order-of-dataframe-row-wise-2/
  .[nrow(.):1, ] %>%
  do(tidy(poisson.test(.$number, .$total))) %>%
  mutate(across(c(estimate, starts_with("conf")), ~ . - 1)) %>%
  ggplot(aes(x = estimate, y = reorder(sentiment, estimate))) +
  geom_point() +
  geom_errorbar(aes(xmin = conf.low, xmax = conf.high)) +
  scale_x_continuous(labels = label_percent()) +
  labs(
    x = "Change from Putin to Zelenskyy",
    y = "Sentiment",
    title = "Negative sentiments more likely for Zelenskyy than Putin"
  ) +
  theme_minimal()
```

Zelenskyy's press releases are 3 times more likely to use angry words than Putin's. Zelenskyy's outrage in contrast to Putin's blase attitude is indicative of each leader's willingness (or lack thereof in the case of Putin) to display alarm over the conflict. It makes sense that Zelenskyy, given the state of emergency into which his country has been plunged, would project negative sentiments in his communications. Such a strategy is more likely to alert international allies of the severity of Ukraine's plight. Putin, on the other hand, having initiated the conflict, probably wants to give the impression that the situation is under control and is therefore apt to downplay the events of these past two months.

Additional Sources:

1. https://intro2r.com/r-markdown-anatomy.html
2. https://bookdown.org/yihui/rmarkdown/markdown-syntax.html
3. https://bookdown.org/yihui/rmarkdown-cookbook/font-color.html
4. https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1467-8640.2012.00460.x
